/*! For license information please see app.c859fa87.js.LICENSE.txt */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[524],{452:(t,e,r)=>{var n=r(6540),o=r(5338),i=(r(2675),r(9463),r(6412),r(2259),r(5700),r(8125),r(6280),r(6918),r(8706),r(2008),r(1629),r(3418),r(4423),r(4346),r(3792),r(4114),r(4490),r(4782),r(9572),r(3288),r(2010),r(4731),r(479),r(2892),r(9904),r(7945),r(4185),r(3851),r(1278),r(875),r(9432),r(3548),r(287),r(6099),r(3362),r(7495),r(906),r(8781),r(1699),r(7764),r(3500),r(2953),r(3296),r(7208),r(8408),r(4603),r(7566),r(8721),r(1083)),a=r(4848);r(2062);var c=r(8465),s=r.n(c),l=r(9644),u=r.n(l);function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function h(){h=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function u(t,e,r,n){var i=e&&e.prototype instanceof b?e:b,a=Object.create(i.prototype),c=new G(n||[]);return o(a,"_invoke",{value:k(t,r,c)}),a}function d(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var p="suspendedStart",m="suspendedYield",v="executing",y="completed",g={};function b(){}function x(){}function w(){}var j={};l(j,a,(function(){return this}));var E=Object.getPrototypeOf,L=E&&E(E(C([])));L&&L!==r&&n.call(L,a)&&(j=L);var N=w.prototype=b.prototype=Object.create(j);function S(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function r(o,i,a,c){var s=d(t[o],t,i);if("throw"!==s.type){var l=s.arg,u=l.value;return u&&"object"==f(u)&&n.call(u,"__await")?e.resolve(u.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(u).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function k(e,r,n){var o=p;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=_(c,n);if(s){if(s===g)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var l=d(e,r,n);if("normal"===l.type){if(o=n.done?y:m,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=y,n.method="throw",n.arg=l.arg)}}}function _(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=d(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function G(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(f(e)+" is not iterable")}return x.prototype=w,o(N,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:x,configurable:!0}),x.displayName=l(w,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===x||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,l(t,s,"GeneratorFunction")),t.prototype=Object.create(N),t},e.awrap=function(t){return{__await:t}},S(O.prototype),l(O.prototype,c,(function(){return this})),e.AsyncIterator=O,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new O(u(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},S(N),l(N,s,"Generator"),l(N,a,(function(){return this})),l(N,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,G.prototype={constructor:G,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(s&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function d(t){return function(t){if(Array.isArray(t))return w(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||x(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function m(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){p(i,n,o,a,c,"next",t)}function c(t){p(i,n,o,a,c,"throw",t)}a(void 0)}))}}function v(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function y(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?v(Object(r),!0).forEach((function(e){g(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function g(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=f(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==f(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function b(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,c=[],s=!0,l=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(c.push(n.value),c.length!==e);s=!0);}catch(t){l=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(t,e)||x(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(t,e){if(t){if("string"==typeof t)return w(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?w(t,e):void 0}}function w(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}const j=function(t){var e=t.setGroups,r=b((0,n.useState)(null),2),o=(r[0],r[1]),i=b((0,n.useState)(!1),2),c=i[0],l=i[1],f=u()(s()),p=b((0,n.useState)(null),2),v=p[0],x=p[1],w=(0,n.useRef)(null),j={nameGroup:"",photoGroup:null,descriptionGroup:""},E=b((0,n.useState)(j),2),L=E[0],N=E[1],S=function(t){var e=t.target,r=e.name,n=e.value,o=e.type,i=e.files;if("file"===o){var a=i[0];if(N((function(t){return y(y({},t),{},g({},r,a))})),a){var c=new FileReader;c.onloadend=function(){x(c.result)},c.readAsDataURL(a)}else x(null)}else N((function(t){return y(y({},t),{},g({},r,n))}))},O=function(){N(j),x(null),w.current&&w.current.reset()};(0,n.useEffect)((function(){var t=document.getElementById("modal_add_group");c&&t&&(O(),t.showModal())}),[c]);var k=function(){l(!1),document.getElementById("modal_add_group").close(),O()},_=function(){var t=m(h().mark((function t(){var r,n,i,a;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(r=new FormData).append("nameGroup",L.nameGroup),r.append("descriptionGroup",L.descriptionGroup),L.photoGroup&&r.append("photoGroup",L.photoGroup),t.next=7,fetch("/api/groups/create",{method:"POST",body:r});case 7:if((n=t.sent).ok){t.next=10;break}throw new Error("Network response was not ok");case 10:return t.next=12,n.json();case 12:if(!(i=t.sent).success){t.next=22;break}return e((function(t){return[].concat(d(t),[i.group])})),k(),(a=document.getElementById("modal_add_group"))&&a.close(),t.next=20,f.fire({title:"Success!",text:"Group created successfully",icon:"success",didOpen:function(){f.hideLoading()}});case 20:t.next=23;break;case 22:throw new Error(i.message||"An error occurred");case 23:t.next=31;break;case 25:return t.prev=25,t.t0=t.catch(0),t.next=29,f.fire({title:"Error!",text:t.t0.message||"Failed to create group",icon:"error",didOpen:function(){f.hideLoading()}});case 29:o("Failed to create group"),console.error("Error:",t.t0);case 31:case"end":return t.stop()}}),t,null,[[0,25]])})));return function(){return t.apply(this,arguments)}}(),A=function(){var t=m(h().mark((function t(e){var r,n;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),(r=document.getElementById("modal_add_group"))&&r.close(),t.next=5,f.fire({title:"Do you want to save the changes?",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Save",denyButtonText:"Don't save",didOpen:function(){f.hideLoading()}});case 5:if(!(n=t.sent).isConfirmed){t.next=11;break}return t.next=9,_();case 9:t.next=18;break;case 11:if(!n.isDenied){t.next=17;break}return t.next=14,f.fire({title:"Changes are not saved",icon:"info",didOpen:function(){f.hideLoading()}});case 14:k(),t.next=18;break;case 17:r.showModal();case 18:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return(0,a.jsxs)("dialog",{id:"modal_add_group",className:"modal",onClose:k,children:[(0,a.jsxs)("div",{className:"modal-box",children:[(0,a.jsx)("h3",{className:"text-lg font-bold",children:"Add Group"}),(0,a.jsx)("div",{className:"w-full max-w-md space-y-8",children:(0,a.jsxs)("form",{ref:w,className:"mt-8 space-y-6",onSubmit:A,encType:"multipart/form-data",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"inputName",className:"block text-sm font-medium text-gray-700",children:"Name"}),(0,a.jsx)("input",{id:"inputName",name:"nameGroup",type:"text",required:!0,className:"block w-full px-3 py-2 mt-1 text-gray-900 placeholder-gray-500 border border-gray-300 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Group name",onChange:S,value:L.nameGroup})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"inputPhoto",className:"block text-sm font-medium text-gray-700",children:"Photo"}),(0,a.jsxs)("div",{className:"flex items-center mt-1 space-x-4",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:v?(0,a.jsx)("img",{src:v,alt:"Preview",className:"object-cover w-16 h-16 rounded-full"}):(0,a.jsx)("div",{className:"flex items-center justify-center w-16 h-16 bg-gray-200 rounded-full",children:(0,a.jsx)("svg",{className:"w-8 h-8 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})})}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("input",{id:"inputPhoto",name:"photoGroup",type:"file",accept:"image/*",className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100",onChange:S})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"inputDescription",className:"block text-sm font-medium text-gray-700",children:"Description"}),(0,a.jsx)("input",{id:"inputDescription",name:"descriptionGroup",type:"text",className:"block w-full px-3 py-2 mt-1 text-gray-900 placeholder-gray-500 border border-gray-300 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Group description",onChange:S,value:L.descriptionGroup})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)("button",{type:"button",className:"btn btn-ghost",onClick:k,children:"Cancel"}),(0,a.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Submit"})]})]})})]}),(0,a.jsx)("form",{method:"dialog",className:"modal-backdrop",children:(0,a.jsx)("button",{onClick:k,children:"close"})})]})};function E(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,c=[],s=!0,l=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(c.push(n.value),c.length!==e);s=!0);}catch(t){l=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return L(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?L(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var N=(0,n.createContext)({isAdmin:!1,toggleAdmin:function(){}});function S(t){var e=t.children,r=E((0,n.useState)(!1),2),o=r[0],i=r[1];return(0,a.jsx)(N.Provider,{value:{isAdmin:o,toggleAdmin:function(){i(!0)}},children:e})}const O=function(t){var e=t.groups,r=t.handleGroupClick,o=t.setGroups,i=(0,n.useContext)(N).isAdmin;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(j,{setGroups:o}),(0,a.jsx)("div",{className:"flex flex-col w-full ".concat(i?"mt-3":"mt-10","  space-y-2 overflow-y-auto h-1/3"),children:e.map((function(t){var e;return(0,a.jsxs)("div",{onClick:function(){return r(t)},className:"flex items-center p-1 transition-all rounded-lg cursor-pointer hover:bg-gray-200",children:[(0,a.jsx)("img",{src:"".concat("http://localhost:8000","/uploads/groups/").concat(null!==(e=t.photo)&&void 0!==e?e:"group_default_avatar.jpg"),alt:t.name,className:"w-10 h-10 mr-2 border-white rounded-full"}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"font-medium text-gray-700",children:t.name}),(0,a.jsx)("div",{className:"flex items-center ml-2"})]})]},t.id)}))})]})};r(5086),r(2762),r(6031);var k=r(3829);r(8156);const _=function(t){if(!t)return"";var e=new Date(t);if(isNaN(e.getTime()))return"";var r=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate()),o=new Date(r.getFullYear(),r.getMonth(),r.getDate()),i=new Date(o);if(i.setDate(o.getDate()-1),n.getTime()===o.getTime())return"".concat(e.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"}));if(n.getTime()===i.getTime())return"Hier";var a=o-n,c=Math.ceil(a/864e5);return c<=30?"Il y a ".concat(c," jour").concat(c>1?"s":""):"".concat(e.toLocaleDateString("fr-FR")," ").concat(e.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"}))};const A=function(t){var e,r=t.member,o=t.BASE_URL,i=t.isOpen,c=t.onClose,s=t.currentUser,l="".concat(o,"/uploads/profiles/").concat(null!==(e=r.profilePicture)&&void 0!==e?e:"default_avatar.png");(0,n.useEffect)((function(){var t=document.getElementById("member-profile-modal");i&&t&&t.showModal()}),[i]);var u,f,h,d,p,m=function(){var t=document.getElementById("member-profile-modal");t&&t.close(),c()};return(0,a.jsxs)("dialog",{id:"member-profile-modal",className:"modal",onClose:m,children:[(0,a.jsxs)("div",{className:"relative flex flex-col items-center w-11/12 max-w-md modal-box bg-base-100",children:[(0,a.jsx)("div",{className:"absolute left-0 w-full h-32 rounded-t-lg bg-gradient-to-r from-primary to-secondary opacity-90"}),(0,a.jsx)("div",{className:"z-10 -mb-16 rounded-full ring-4 ring-base-100 ring-offset-2 mt-14",children:(0,a.jsx)("div",{className:"w-32 h-32 overflow-hidden rounded-full shadow-xl",children:(0,a.jsx)("img",{src:l,alt:"".concat(r.username,"'s profile"),className:"object-cover w-full h-full"})})}),(0,a.jsxs)("div",{className:"flex flex-col items-center w-full mt-20 space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-center",children:r.id==s.id?"Vous":r.username}),(0,a.jsx)("span",{className:"inline-block w-3 h-3 rounded-full ".concat(r.isConnected?"bg-success":"bg-gray-400")})]}),(0,a.jsxs)("div",{className:"flex flex-col items-center space-y-2 text-center",children:[(0,a.jsx)("span",{className:"px-4 py-1 text-sm rounded-full bg-base-200",children:r.email}),(0,a.jsxs)("p",{className:"text-sm text-base-content/70",children:["Date d'entrée: ",(u=r.createdAt,f=new Date(u),h=String(f.getDate()).padStart(2,"0"),d=String(f.getMonth()+1).padStart(2,"0"),p=f.getFullYear(),"".concat(h,"-").concat(d,"-").concat(p))]})]})]}),(0,a.jsx)("div",{className:"modal-action",children:(0,a.jsx)("form",{method:"dialog",className:"space-x-2",children:(0,a.jsx)("button",{className:"btn btn-ghost",onClick:m,children:"Close"})})})]}),(0,a.jsx)("form",{method:"dialog",className:"modal-backdrop",children:(0,a.jsx)("button",{onClick:m,children:"close"})})]})};const P=function(t){var e,r=t.member,o=t.BASE_URL,i=t.handleShowMemberProfile,c="".concat(o,"/uploads/profiles/").concat(null!==(e=r.profilePicture)&&void 0!==e?e:"default_avatar.png"),s=(0,n.useContext)(N).isAdmin;return(0,a.jsx)("li",{className:"transition-all duration-300 rounded-lg cursor-pointer group hover:bg-base-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between w-full gap-4 p-4",children:[(0,a.jsxs)("div",{className:"flex items-center flex-1 gap-4",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"w-12 h-12 overflow-hidden rounded-full ring-2 ring-base-300",children:(0,a.jsx)("img",{className:"object-cover w-full h-full transition-transform duration-300 group-hover:scale-110",src:c,alt:r.username})}),(0,a.jsx)("span",{className:"absolute bottom-0 right-0 w-3 h-3 border-2 border-white rounded-full ".concat(r.isConnected?"bg-success":"bg-gray-400")})]}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h3",{className:"text-base font-semibold truncate",children:r.username}),r.isVerified&&(0,a.jsx)("span",{className:"text-primary",children:(0,a.jsx)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor",children:(0,a.jsx)("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"})})})]}),r.role&&(0,a.jsx)("p",{className:"text-sm truncate text-base-content/70",children:r.role})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 transition-opacity opacity-0 group-hover:opacity-100",children:[(0,a.jsx)("button",{className:"btn btn-ghost btn-sm tooltip tooltip-left","data-tip":"View Profile",onClick:i(r),children:(0,a.jsxs)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),s&&(0,a.jsxs)("div",{className:"dropdown dropdown-end",children:[(0,a.jsx)("label",{tabIndex:0,className:"btn btn-ghost btn-sm",children:(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})})}),(0,a.jsxs)("ul",{tabIndex:0,className:"dropdown-content z-[1] menu p-2 shadow-lg bg-base-100 rounded-box w-52",children:[(0,a.jsx)("li",{children:(0,a.jsx)("a",{children:"Add to Group"})}),(0,a.jsx)("li",{children:(0,a.jsx)("a",{children:"Block User"})}),(0,a.jsx)("li",{children:(0,a.jsx)("a",{className:"text-error",children:"Report"})})]})]})]})]})},r.id)};function G(t){return G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},G(t)}function C(){C=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function u(t,e,r,n){var i=e&&e.prototype instanceof y?e:y,a=Object.create(i.prototype),c=new A(n||[]);return o(a,"_invoke",{value:S(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var h="suspendedStart",d="suspendedYield",p="executing",m="completed",v={};function y(){}function g(){}function b(){}var x={};l(x,a,(function(){return this}));var w=Object.getPrototypeOf,j=w&&w(w(P([])));j&&j!==r&&n.call(j,a)&&(x=j);var E=b.prototype=y.prototype=Object.create(x);function L(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function N(t,e){function r(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var l=s.arg,u=l.value;return u&&"object"==G(u)&&n.call(u,"__await")?e.resolve(u.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(u).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function S(e,r,n){var o=h;return function(i,a){if(o===p)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=O(c,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var l=f(e,r,n);if("normal"===l.type){if(o=n.done?m:d,l.arg===v)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=m,n.method="throw",n.arg=l.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function P(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(G(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=l(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,l(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},L(N.prototype),l(N.prototype,c,(function(){return this})),e.AsyncIterator=N,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new N(u(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(E),l(E,s,"Generator"),l(E,a,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=P,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(s&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:P(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function I(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function T(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?I(Object(r),!0).forEach((function(e){D(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function D(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=G(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=G(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==G(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function F(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function M(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,c=[],s=!0,l=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(c.push(n.value),c.length!==e);s=!0);}catch(t){l=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return U(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?U(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function U(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}const B=function(t){var e,r=t.group,o=t.setMembers,c=t.members,s=t.BASE_URL,l=t.isOpen,u=t.onClose,f=t.currentUser,h=M((0,n.useState)(null),2),d=h[0],p=h[1],m=M((0,n.useState)(!1),2),v=m[0],y=m[1],g="".concat(s,"/uploads/groups/").concat(null!==(e=r.photo)&&void 0!==e?e:"group_default_avatar.jpg");(0,n.useEffect)((function(){var t=document.getElementById("group-profile-modal");l&&t&&t.showModal()}),[l]);var b=function(){var t=document.getElementById("group-profile-modal");t&&t.close(),u()},x=function(t){return function(){var e,r=(e=C().mark((function e(r){var n;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.prev=1,e.next=4,i.A.get("http://localhost:8000/api/user/show/".concat(t.id));case 4:200===(n=e.sent).status&&o((function(t){return t.map((function(t){return t.id===data.id?T(T({},t),data):t}))})),console.log(n),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error("Error connecting user:",e.t0);case 12:p(t),y(!0);case 14:case"end":return e.stop()}}),e,null,[[1,9]])})),function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(t){F(i,n,o,a,c,"next",t)}function c(t){F(i,n,o,a,c,"throw",t)}a(void 0)}))});return function(t){return r.apply(this,arguments)}}()};return(0,a.jsxs)("dialog",{id:"group-profile-modal",className:"modal",onClose:b,children:[(0,a.jsxs)("div",{className:"relative flex flex-col items-center w-11/12 max-w-md modal-box bg-base-100",children:[(0,a.jsx)("div",{className:"absolute left-0 w-full h-32 rounded-t-lg bg-gradient-to-r from-primary to-secondary opacity-90"}),(0,a.jsx)("div",{className:"z-10 -mb-16 rounded-full ring-4 ring-base-100 ring-offset-2 mt-14",children:(0,a.jsx)("div",{className:"w-32 h-32 overflow-hidden rounded-full shadow-xl",children:(0,a.jsx)("img",{src:g,alt:"".concat(r.name,"'s profile"),className:"object-cover w-full h-full"})})}),(0,a.jsx)("h3",{children:r.name}),(0,a.jsx)("div",{className:"w-full mt-20",children:(0,a.jsx)("ul",{className:"max-w-md divide-y divide-gray-200 dark:divide-gray-700",children:c.map((function(t){return(0,a.jsx)(P,{member:t,BASE_URL:s,handleShowMemberProfile:x},t.id)}))})}),d&&(0,a.jsx)(A,{member:d,BASE_URL:s,isOpen:v,onClose:function(){y(!1),p(null)},currentUser:f}),(0,a.jsx)("div",{className:"modal-action",children:(0,a.jsx)("form",{method:"dialog",className:"space-x-2",children:(0,a.jsx)("button",{className:"btn btn-ghost",onClick:b,children:"Close"})})})]}),(0,a.jsx)("form",{method:"dialog",className:"modal-backdrop",children:(0,a.jsx)("button",{onClick:b,children:"close"})})]})};function R(t){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},R(t)}function Y(){Y=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function u(t,e,r,n){var i=e&&e.prototype instanceof y?e:y,a=Object.create(i.prototype),c=new A(n||[]);return o(a,"_invoke",{value:S(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var h="suspendedStart",d="suspendedYield",p="executing",m="completed",v={};function y(){}function g(){}function b(){}var x={};l(x,a,(function(){return this}));var w=Object.getPrototypeOf,j=w&&w(w(P([])));j&&j!==r&&n.call(j,a)&&(x=j);var E=b.prototype=y.prototype=Object.create(x);function L(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function N(t,e){function r(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var l=s.arg,u=l.value;return u&&"object"==R(u)&&n.call(u,"__await")?e.resolve(u.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(u).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function S(e,r,n){var o=h;return function(i,a){if(o===p)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=O(c,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var l=f(e,r,n);if("normal"===l.type){if(o=n.done?m:d,l.arg===v)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=m,n.method="throw",n.arg=l.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function P(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(R(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=l(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,l(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},L(N.prototype),l(N.prototype,c,(function(){return this})),e.AsyncIterator=N,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new N(u(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(E),l(E,s,"Generator"),l(E,a,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=P,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(s&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:P(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function z(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function V(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){z(i,n,o,a,c,"next",t)}function c(t){z(i,n,o,a,c,"throw",t)}a(void 0)}))}}function $(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,c=[],s=!0,l=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(c.push(n.value),c.length!==e);s=!0);}catch(t){l=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return W(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?W(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function W(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}const q=function(t){var e,r=t.group,o=t.members,c=t.BASE_URL,l=t.currentUser,f=t.setGroups,h=$((0,n.useState)(r),2),d=h[0],p=h[1],m=$((0,n.useState)(null),2),v=m[0],y=m[1],g=$((0,n.useState)(!1),2),b=g[0],x=g[1],w=$((0,n.useState)(!1),2),j=w[0],E=w[1],L=(null==o?void 0:o.length)||0,S="".concat(c,"/uploads/groups/").concat(null!==(e=null==d?void 0:d.photo)&&void 0!==e?e:"group_default_avatar.jpg"),O=function(t){return function(e){e.preventDefault(),y(t),x(!0)}},k=function(t){return function(e){e.preventDefault(),p(t),E(!0)}},_=u()(s()),P=function(){var t=V(Y().mark((function t(e){var r;return Y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i.A.post("/api/groups/delete/".concat(e));case 3:if(!(r=t.sent).data.success){t.next=12;break}return f((function(t){return t.filter((function(t){return t.id!==e}))})),p(null),t.next=9,_.fire({title:"Success!",text:"Group deleted successfully",icon:"success",didOpen:function(){_.hideLoading()}});case 9:return t.abrupt("return",!0);case 12:throw new Error(r.data.message||"An error occurred");case 13:t.next=21;break;case 15:return t.prev=15,t.t0=t.catch(0),t.next=19,_.fire({title:"Error!",text:t.t0.message||"Failed to delete group",icon:"error",didOpen:function(){_.hideLoading()}});case 19:return console.error("Error:",t.t0),t.abrupt("return",!1);case 21:case"end":return t.stop()}}),t,null,[[0,15]])})));return function(e){return t.apply(this,arguments)}}(),G=function(){var t=V(Y().mark((function t(e){return Y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),t.next=3,_.fire({title:"Do you want to delete the group?",text:"This action cannot be undone.",icon:"question",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!",didOpen:function(){_.hideLoading()}});case 3:if(!t.sent.isConfirmed){t.next=9;break}return t.next=7,P(r.id);case 7:t.sent&&E(!1);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),C=(0,n.useContext)(N).isAdmin;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center min-w-52 w-52",children:[(0,a.jsxs)("div",{className:"flex items-center flex-1 min-w-0",children:[(0,a.jsx)("img",{src:S,alt:(null==r?void 0:r.name)||"Group",className:"mr-2 rounded-full cursor-pointer w-7 h-7 tooltip tooltip-bottom",onClick:k(r)}),(0,a.jsx)("span",{className:"font-medium truncate",children:(null==r?void 0:r.name)||"Select a group"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"relative z-0 flex -space-x-2 avatar-group rtl:space-x-reverse",children:[o&&0!==L?L<=3?o.map((function(t){var e;return(0,a.jsx)("div",{className:"tooltip tooltip-bottom","data-tip":t.username,children:(0,a.jsx)("div",{className:"avatar",children:(0,a.jsx)("div",{className:"w-6 h-6 overflow-hidden transition-all rounded-full cursor-pointer hover:ring-2 hover:ring-primary",onClick:O(t),children:(0,a.jsx)("img",{src:"".concat(c,"/uploads/profiles/").concat(null!==(e=t.profilePicture)&&void 0!==e?e:"default_avatar.png"),alt:"Avatar ".concat(t.username),className:"object-cover w-full h-full"})})})},t.id)})):o.slice(0,2).map((function(t){var e;return(0,a.jsx)("div",{className:"tooltip tooltip-bottom","data-tip":t.username,children:(0,a.jsx)("div",{className:"avatar",children:(0,a.jsx)("div",{className:"w-6 h-6 overflow-hidden transition-all rounded-full cursor-pointer hover:ring-2 hover:ring-primary",onClick:O(t),children:(0,a.jsx)("img",{src:"".concat(c,"/uploads/profiles/").concat(null!==(e=t.profilePicture)&&void 0!==e?e:"default_avatar.png"),alt:"Avatar ".concat(t.username),className:"object-cover w-full h-full"})})})},t.id)})):null,L>3&&(0,a.jsx)("div",{className:"tooltip tooltip-bottom","data-tip":"".concat(L-2," more members"),children:(0,a.jsx)("div",{className:"avatar placeholder",onClick:k(r),children:(0,a.jsx)("div",{className:"flex items-center justify-center w-6 h-6 text-xs rounded-full cursor-pointer bg-neutral text-neutral-content",children:(0,a.jsxs)("span",{children:["+",L-2]})})})})]}),C&&(0,a.jsxs)("div",{className:"dropdown dropdown-end",children:[(0,a.jsx)("label",{tabIndex:0,className:"btn btn-ghost btn-circle btn-sm",children:(0,a.jsx)("img",{src:"".concat(c,"/images/dots.png"),alt:"Menu",className:"w-5 h-5"})}),(0,a.jsxs)("ul",{tabIndex:0,className:"dropdown-content z-[100] menu p-2 shadow-lg bg-base-100 rounded-box w-52",children:[(0,a.jsx)("li",{children:(0,a.jsx)("a",{children:"Group Settings"})}),(0,a.jsx)("li",{children:(0,a.jsx)("a",{children:"Manage Members"})}),(0,a.jsx)("li",{children:(0,a.jsx)("a",{className:"text-error",onClick:G,children:"Delete Group"})})]})]})]})]}),v&&(0,a.jsx)(A,{member:v,BASE_URL:c,isOpen:b,onClose:function(){x(!1),y(null)},currentUser:l}),d&&(0,a.jsx)(B,{group:d,members:o,BASE_URL:c,isOpen:j,onClose:function(){E(!1),p(r)},currentUser:l})]})};function J(t){return J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},J(t)}function H(t){return function(t){if(Array.isArray(t))return et(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||tt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function K(){K=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function u(t,e,r,n){var i=e&&e.prototype instanceof y?e:y,a=Object.create(i.prototype),c=new A(n||[]);return o(a,"_invoke",{value:S(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var h="suspendedStart",d="suspendedYield",p="executing",m="completed",v={};function y(){}function g(){}function b(){}var x={};l(x,a,(function(){return this}));var w=Object.getPrototypeOf,j=w&&w(w(P([])));j&&j!==r&&n.call(j,a)&&(x=j);var E=b.prototype=y.prototype=Object.create(x);function L(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function N(t,e){function r(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var l=s.arg,u=l.value;return u&&"object"==J(u)&&n.call(u,"__await")?e.resolve(u.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(u).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function S(e,r,n){var o=h;return function(i,a){if(o===p)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=O(c,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var l=f(e,r,n);if("normal"===l.type){if(o=n.done?m:d,l.arg===v)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=m,n.method="throw",n.arg=l.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function P(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(J(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=l(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,l(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},L(N.prototype),l(N.prototype,c,(function(){return this})),e.AsyncIterator=N,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new N(u(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(E),l(E,s,"Generator"),l(E,a,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=P,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(s&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:P(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function Q(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function X(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Q(i,n,o,a,c,"next",t)}function c(t){Q(i,n,o,a,c,"throw",t)}a(void 0)}))}}function Z(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,c=[],s=!0,l=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(c.push(n.value),c.length!==e);s=!0);}catch(t){l=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(t,e)||tt(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tt(t,e){if(t){if("string"==typeof t)return et(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?et(t,e):void 0}}function et(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}const rt=function(t){var e=t.group,r=t.currentUser,o=t.members,c=t.setGroups,s=Z((0,n.useState)([]),2),l=s[0],u=s[1],f=Z((0,n.useState)(""),2),h=f[0],d=f[1],p=Z((0,n.useState)([]),2),m=(p[0],p[1],Z((0,n.useState)("hidden"),2)),v=m[0],y=m[1],g=Z((0,n.useState)("block"),2),b=(g[0],g[1]),x=(0,n.useRef)(null),w=(0,n.useRef)(null);o.length,(0,n.useEffect)((function(){var t=function(t){t.target.closest(".writing-area")||"block"!==v||(y("hidden"),b("block"))};return document.addEventListener("mousedown",t),function(){document.removeEventListener("mousedown",t)}}),[v]),(0,n.useEffect)((function(){var t;null===(t=x.current)||void 0===t||t.scrollIntoView({behavior:"smooth"})}),[l]),(0,n.useEffect)((function(){var t=function(){var t=X(K().mark((function t(){var r;return K().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i.A.get("http://localhost:8000/api/chat/messages/".concat(e.id));case 3:r=t.sent,Array.isArray(r.data)?u(r.data):console.error("Les données reçues ne sont pas un tableau:",r.data),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("Error loading messages:",t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();if(t(),window.MERCURE_PUBLIC_URL){var r="".concat(window.MERCURE_PUBLIC_URL,"?topic=chat");console.log("Connecting to Mercure hub:",r);var n=new EventSource(r,{withCredentials:!1});return n.onmessage=function(t){var r=JSON.parse(t.data);r.message.message.send_to==e.id&&u((function(t){return t.some((function(t){return t.id===r.message.message.id}))?t:[].concat(H(t),[r.message])}))},function(){n.close()}}console.error("MERCURE_PUBLIC_URL is not defined")}),[e,r.id]);var j=function(){var t=X(K().mark((function t(n){var o,a;return K().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),""!==h.trim()){t.next=3;break}return t.abrupt("return");case 3:return t.prev=3,t.next=6,i.A.post("http://localhost:8000/api/chat/send/".concat(e.id),{message:h,recipients:e.id});case 6:o=t.sent,void 0===(a=o.data).user_id&&(a.user_id=r.id),u((function(t){return t.some((function(t){return t.id===a.id}))?t:[].concat(H(t),[a])})),d(""),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(3),console.error("Error sending message:",t.t0);case 16:return t.prev=16,y("hidden"),b("block"),t.finish(16);case 20:case"end":return t.stop()}}),t,null,[[3,13,16,20]])})));return function(e){return t.apply(this,arguments)}}();return(0,n.useContext)(N).isAdmin,(0,a.jsxs)("div",{className:"flex flex-col h-full",children:[(0,a.jsx)("div",{className:"sticky top-0 flex items-center h-8 p-1 text-lg font-semibold bg-white border-b border-gray-300 ".concat("w-2/6"," "),children:(0,a.jsx)(q,{group:e,members:o,BASE_URL,currentUser:r,setGroups:c})}),(0,a.jsxs)("div",{className:"flex-grow px-4",children:[(0,a.jsx)("ul",{className:"space-y-4",children:l.map((function(t){var e=void 0!==t.user.id?t.user.id:r.id;return(0,a.jsx)("li",{className:"mb-2 ".concat(e===r.id?"text-right":"text-left"),children:(0,a.jsx)("div",{className:"flex ".concat(e===r.id?"justify-end":"justify-start"," mb-2"),children:(0,a.jsxs)("div",{className:"flex flex-col ".concat(e===r.id?"items-end":"items-start"),children:[(0,a.jsx)("small",{className:"text-[10px] text-gray-500 mb-1 flex flex-row",children:(0,a.jsx)("span",{className:"flex items-center",children:t.user.username})}),(0,a.jsxs)("div",{className:"inline-block px-4 py-1 text-sm font-lato rounded-lg shadow-md max-w-xs ".concat(e===r.id?"bg-blue-500 text-white rounded-br-none":"bg-gray-200 text-black rounded-bl-none"),style:{textAlign:"justify",textJustify:"inter-word",wordWrap:"break-word",whiteSpace:"pre-line"},children:[t.message.body,(0,a.jsx)("small",{className:"relative block text-[8px] opacity-70 mt-1 text-right z-10",children:_(t.message.created_at)})]})]})})},t.message.id+""+(0,k.A)())}))}),(0,a.jsx)("form",{ref:w,onSubmit:j,className:"relative ".concat(v," writing-area"),children:(0,a.jsxs)("div",{className:"flex items-center p-4 bg-gray-100 border-t border-gray-300",children:[(0,a.jsx)("textarea",{className:"flex-grow p-2 mr-4 text-sm bg-white border rounded-lg outline-none",placeholder:"Écrire un message...",value:h,onChange:function(t){return d(t.target.value)}}),(0,a.jsx)("button",{className:"px-4 py-2 text-white rounded-lg shadow-lg cursor-pointer bg-primary",children:"Envoyer"})]})}),(0,a.jsx)("div",{ref:x})]}),(0,a.jsx)("div",{className:"sticky bottom-[20%] left-2",children:(0,a.jsx)("img",{src:"http://localhost:8000/images/icons.png",alt:"Cliquer pour écrire un message",className:"w-10 h-10 rounded-full",onClick:function(){y("block"),b("hidden"),setTimeout((function(){var t;null===(t=w.current)||void 0===t||t.scrollIntoView({behavior:"smooth",block:"end"})}),100)}})})]})};const nt=function(t){var e=t.notMembers,r=t.handleAddMember,n=t.group;return t.setMembers,(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{className:"flex flex-col mt-10 space-y-2",children:e.map((function(t){return(0,a.jsxs)("div",{className:"flex flex-row items-center justify-between p-1 transition-all",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-10 h-10 mr-2 bg-white border-white rounded-full"}),(0,a.jsx)("div",{className:"font-medium text-gray-700",children:(0,a.jsx)("span",{className:"cursor-pointer",children:t.username})})]}),(0,a.jsx)("button",{className:"h-fit bg-primary cursor-pointer text-[8px] text-white p-1 rounded-md hover:bg-primary/80 transition-all",onClick:function(){return r(n.id,t.id)},children:"Ajouter"})]},t.id)}))})})};function ot(t){return ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ot(t)}function it(t){return function(t){if(Array.isArray(t))return pt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||dt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function at(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function ct(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?at(Object(r),!0).forEach((function(e){st(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):at(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function st(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=ot(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=ot(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ot(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lt(){lt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function u(t,e,r,n){var i=e&&e.prototype instanceof y?e:y,a=Object.create(i.prototype),c=new A(n||[]);return o(a,"_invoke",{value:S(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var h="suspendedStart",d="suspendedYield",p="executing",m="completed",v={};function y(){}function g(){}function b(){}var x={};l(x,a,(function(){return this}));var w=Object.getPrototypeOf,j=w&&w(w(P([])));j&&j!==r&&n.call(j,a)&&(x=j);var E=b.prototype=y.prototype=Object.create(x);function L(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function N(t,e){function r(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var l=s.arg,u=l.value;return u&&"object"==ot(u)&&n.call(u,"__await")?e.resolve(u.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(u).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function S(e,r,n){var o=h;return function(i,a){if(o===p)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=O(c,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var l=f(e,r,n);if("normal"===l.type){if(o=n.done?m:d,l.arg===v)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=m,n.method="throw",n.arg=l.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function P(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(ot(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=l(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,l(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},L(N.prototype),l(N.prototype,c,(function(){return this})),e.AsyncIterator=N,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new N(u(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(E),l(E,s,"Generator"),l(E,a,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=P,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(s&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:P(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function ut(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function ft(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){ut(i,n,o,a,c,"next",t)}function c(t){ut(i,n,o,a,c,"throw",t)}a(void 0)}))}}function ht(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,c=[],s=!0,l=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(c.push(n.value),c.length!==e);s=!0);}catch(t){l=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(t,e)||dt(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dt(t,e){if(t){if("string"==typeof t)return pt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?pt(t,e):void 0}}function pt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}const mt=function(){var t,e=ht((0,n.useState)([]),2),r=e[0],o=e[1],c=ht((0,n.useState)(null),2),s=c[0],l=c[1],u=ht((0,n.useState)([]),2),f=u[0],h=u[1],d=ht((0,n.useState)([]),2),p=d[0],m=d[1],v=ht((0,n.useState)(null),2),y=v[0],g=v[1],b=ht((0,n.useState)(null),2),x=b[0],w=b[1],j=ht((0,n.useState)(""),2),E=(j[0],j[1],ht((0,n.useState)(!0),2)),L=E[0],S=E[1],k=(0,n.useContext)(N),_=k.isAdmin,A=k.toggleAdmin;(0,n.useEffect)((function(){var t=function(){var t=ft(lt().mark((function t(){var e;return lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i.A.get("http://localhost:8000/api/user/current");case 3:(e=t.sent).data?(w(e.data),e.data.roles.includes("ROLE_ADMIN")&&A()):window.location("/login"),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("Error loading current user:",t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();t()}),[]),(0,n.useEffect)((function(){if(x){var t=function(){var t=ft(lt().mark((function t(){var e;return lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,S(!0),t.next=4,i.A.get("http://localhost:8000/api/groups");case 4:e=t.sent,o(e.data),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.error("Error loading friends:",t.t0);case 11:return t.prev=11,S(!1),t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,8,11,14]])})));return function(){return t.apply(this,arguments)}}();t();var e=new URL("http://localhost:3000/.well-known/mercure");e.searchParams.append("topic","/user/".concat(x.id,"/friends/status")),new EventSource(e).onmessage=function(t){try{var e=JSON.parse(t.data);y&&y.id===e.userId&&g((function(t){return ct(ct({},t),{},{connected:e.connected})}))}catch(t){console.error("Erreur lors du traitement du message:",t)}}}}),[x,y]),(0,n.useEffect)((function(){var t=function(){var t=ft(lt().mark((function t(){return lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i.A.post("http://localhost:8000/api/user/connect");case 3:t.sent,t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.error("Error connecting user:",t.t0);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(){return t.apply(this,arguments)}}();x&&t();var e=function(){navigator.sendBeacon("http://localhost:8000/api/user/disconnect")};return window.addEventListener("beforeunload",e),function(){window.removeEventListener("beforeunload",e),i.A.post("http://localhost:8000/api/user/disconnect")}}),[x]);var P=function(){var t=ft(lt().mark((function t(e,r){var n;return lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i.A.post("http://localhost:8000/api/groups/add/".concat(e,"/").concat(r));case 3:200==(n=t.sent).status&&(h((function(t){return t.filter((function(t){return t.id!==r}))})),m((function(t){return[].concat(it(t),[n.data.member])}))),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("Error connecting user:",t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e,r){return t.apply(this,arguments)}}();return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"flex w-full h-full gap-0",children:[(0,a.jsxs)("div",{className:"flex flex-col flex-none w-1/6 h-screen bg-gray-300 overflow-y-auto",children:[(0,a.jsx)("p",{className:"fixed p-1 pt-[10px] w-1/6 bg-primary text-white font-semibold text-sm justify-center h-8",children:"Vos groupes"}),_&&(0,a.jsx)("div",{className:"w-full mt-10 mb-4",children:(0,a.jsx)("button",{className:"w-full h-8 text-3xl text-white bg-blue-700",onClick:function(){return document.getElementById("modal_add_group").showModal()},children:"+"})}),(0,a.jsx)(O,{groups:r,handleGroupClick:function(t){l(t);var e=function(){var e=ft(lt().mark((function e(){var r;return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.A.get("http://localhost:8000/api/groups/".concat(t.id));case 3:r=e.sent,h(r.data.notMembers),m(r.data.members),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Error loading messages:",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();e()},setGroups:o})]}),(0,a.jsxs)("div",{className:"grow flex flex-col overflow-x-hidden overflow-y-auto bg-white shadow-lg h-screen",children:[(0,a.jsx)("div",{className:"w-full h-8 bg-gray-200",children:(0,a.jsx)("header",{className:"flex flex-col w-full h-8 p-0 mb-0 text-lg font-semibold bg-gray-300 items-center justify-center",children:L?(0,a.jsx)(a.Fragment,{}):x?(0,a.jsx)("div",{className:"flex items-center space-x-2",children:(0,a.jsx)("div",{children:null!==(t=x.username)&&void 0!==t?t:""})}):(0,a.jsx)("p",{children:"Erreur de chargement de l'utilisateur"})})}),s&&(0,a.jsx)(rt,{group:s,currentUser:x,members:p,setGroups:o})]}),_&&s&&(0,a.jsxs)("div",{className:"flex flex-col flex-none w-1/6 h-screen bg-gray-300 overflow-y-auto",children:[(0,a.jsxs)("p",{className:"fixed p-1 pt-[10px] w-full bg-primary text-white font-semibold text-sm justify-center h-8",children:["Pas encore membre de ",s.name]}),f.length>0&&(0,a.jsx)(nt,{notMembers:f,handleAddMember:P,group:s,setMembers:m})]})]})})};window.MERCURE_PUBLIC_URL="http://localhost:3000/.well-known/mercure",document.addEventListener("DOMContentLoaded",(function(){var t=document.getElementById("root");t&&(0,o.createRoot)(t).render((0,a.jsx)(S,{children:(0,a.jsx)(mt,{})}))}))}},t=>{t.O(0,[617],(()=>{return e=452,t(t.s=e);var e}));t.O()}]);